var Version = 1, WasMultipagosTPCCreated = !1; function setVersion(e) { Version = e } function getSecureLinkBackend(e) { selectedMSIPlans = getSelectedSecureLinksPlans(); var n = JSON.parse(document.getElementById("thirdPartyCheckoutsInformation").value); e = { MasterLocatorId: document.getElementById("masterLocatorId").value, Amount: document.getElementById("pendingToPay").value, PaymentProcessOptionType: n.Multipagos.PaymentProcessOptionType, Provider: n.Multipagos.Provider, SiteReturnUrl: n.Multipagos.SiteReturn, SpecificProviderDetails: JSON.stringify({ MSIPlans: selectedMSIPlans }) }; jQuery.ajax({ type: "POST", url: "/CreateThirdPartyCheckoutTransaction", data: JSON.stringify(e), dataType: "json", contentType: "application/json; charset=utf-8", success: function (e) { 0 === e.ResponseCode ? (jQuery("#thirdPartyCheckoutUrl").val(e.CopyUrl), secureLinkPlansDisplayAfterCreation(selectedplansArray), secureLinkCreateLinkVisualSuccess()) : (jQuery("#thirdPartyCheckoutUrl").val(""), printDisplayPlans(""), showErrorMessage(e.ResponseMessage)) }, error: function () { showErrorMessage(), jQuery("#thirdPartyCheckoutUrl").val(""), printDisplayPlans("") } }) } function showErrorMessage(e) { switch (Version) { case 1: toggleSecureLinkError(!0, "" !== e ? e : document.getElementById("thirdPartyCheckoutGenericErrorMessage").value); break; case 2: showMessageAlertWithTitleSecureLink() } } function hideErrorMessage() { switch (Version) { case 1: toggleSecureLinkError(!1, ""); break; case 2: hideAlertSecureLink() } } function ActivateAllCheckBoxes(e) { jQuery('input[type=checkbox][name^="chkmpTPCPaymentPlan"]').each((function () { "chkmpTPCPaymentPlan-One" != this.name && (this.checked = e.checked) })) } function VerifyAll() { let e = jQuery('input[type=checkbox][name^="chkmpTPCPaymentPlan"]').length, n = jQuery('input[type=checkbox][name^="chkmpTPCPaymentPlan"]:checked').length; jQuery("#chkmpTPCAll").prop("checked", e === n) } function getSelectedSecureLinksPlans() { return selectedplansArray = [], jQuery('input[name^="chkmpTPCPaymentPlan"]').each((function () { control = jQuery(this), control.is(":checkbox") && control.is(":checked") && selectedplansArray.push(parseInt(control.val())) })), selectedplansArray } function secureLinkPlansDisplayAfterCreation(e) { displayplansTextArray = [], jQuery.each(e, (function (e, n) { displayplansTextArray.push(jQuery('input[name="chkmpTPCPaymentPlanHidden-' + n + '"]').val()) })), printDisplayPlans(displayplansTextArray.join(", ")) } function printDisplayPlans(e) { jQuery("#secureLinkPlansDisplay").text(e); let n = ""; switch (Version) { case 1: n = "#H4secureLinkPlansDisplay"; break; case 2: n = "#pSecureLinkPlansDisplay" }e.length > 0 ? jQuery(n).show() : jQuery(n).hide() } function secureLinkChangePlansVisual() { toggleActionEnabled("secureLinkChangePlans", !1), toggleActionEnabled("secureLinkCreateLink", !0), toggleSecureLinkGridEnabled(!0), toggleSecureLinkCopySectionEnabled(!1), toggleSecureLinkError(!1, ""), jQuery("#thirdPartyCheckoutUrl").val(""), printDisplayPlans("") } function secureLinkCreateLinkVisualSuccess() { toggleActionEnabled("secureLinkChangePlans", !0), toggleActionEnabled("secureLinkCreateLink", !1), toggleSecureLinkGridEnabled(!1), toggleSecureLinkCopySectionEnabled(!0), hideErrorMessage() } function toggleSecureLinkGridEnabled(e) { e ? jQuery(".mpTPCControl").each((function () { jQuery(this).is(":disabled") && jQuery(this).removeAttr("disabled") })) : jQuery(".mpTPCControl").each((function () { jQuery(this).is(":disabled") || jQuery(this).attr("disabled", "disabled") })) } function toggleActionEnabled(e, n) { switch (Version) { case 1: toggleHrefEnabled(e, n); break; case 2: toggleButtonEnabled(e, n) } } function toggleSecureLinkCopySectionEnabled(e) { toggleActionEnabled("btnCopyLink", e), e ? jQuery("#thirdPartyCheckoutTooltip").show() : jQuery("#thirdPartyCheckoutTooltip").hide() } function thirdPartyCheckoutCopyToClipboard(e) { let n = document.getElementById("thirdPartyCheckoutUrl"); n.select(), n.setSelectionRange(0, 99999), document.execCommand("copy"), document.getElementById("thirdPartyCheckoutTooltip").innerHTML = e, multipagosPaymentPlanTrackingIEventLogClear(), getSelectedSecureLinksPlans().forEach((e => multipagosPaymentPlanTrackingIEventLog(e))), multipagosCopyLinkIEventLog() } function outFunc(e) { document.getElementById("thirdPartyCheckoutTooltip").innerHTML = e } function toggleSecureLinkError(e, n) { jQuery("#divError").html("<p> {message} </p>".replace("{message}", n)), e ? jQuery("#divError").show() : jQuery("#divError").hide() } function toggleHrefEnabled(e, n) { n ? jQuery("#" + e).hasClass("disabled") && jQuery("#" + e).removeClass("disabled") : jQuery("#" + e).hasClass("disabled") || (jQuery("#" + e).addClass("disabled"), jQuery("#" + e).blur()) } function ActivateFirstTimeSecureLink() { setVersion(2), WasMultipagosTPCCreated || (WasMultipagosTPCCreated = !0, toggleActionEnabled("secureLinkChangePlans", !1), toggleActionEnabled("secureLinkCreateLink", !1), printDisplayPlans(""), toggleSecureLinkCopySectionEnabled(!1), getSecureLinkBackend()) } function toggleButtonEnabled(e, n) { n ? jQuery("#" + e).is(":disabled") && (jQuery("#" + e).removeAttr("disabled"), jQuery("#" + e).removeClass("button--disabled")) : jQuery("#" + e).is(":disabled") || (jQuery("#" + e).attr("disabled", "disabled"), jQuery("#" + e).addClass("button--disabled")) } function showMessageAlertWithTitleSecureLink() { let e = jQuery("#SecureLinkAlertTitle").val(), n = jQuery("#SecureLinkAlertMessage").val(); jQuery("#ValidationAlert").hide(), jQuery("#AnnouncementAlert").show(), jQuery("#announcementAlertTitle").text(e), jQuery("#MessageAlert").html(n) } function hideAlertSecureLink() { let e = $("#originalAlertTitle").val(); jQuery("#ValidationAlert").hide(), jQuery("#AnnouncementAlert").hide(), jQuery("#announcementAlertTitle").text(e), jQuery("#MessageAlert").text("") } jQuery("#secureLinkCreateLink").on("click", (function (e) { 2 === Version && hideAlertSecureLink(), getSecureLinkBackend(), multipagosInteractionLinkWasUpdatedIEventLog() })), jQuery("#secureLinkChangePlans").on("click", (function (e) { secureLinkChangePlansVisual(), 2 === Version && hideAlertSecureLink() })), jQuery(".tab-multipagos").on("click", (function (e) { setVersion(1), WasMultipagosTPCCreated || (WasMultipagosTPCCreated = !0, toggleActionEnabled("secureLinkChangePlans", !1), toggleActionEnabled("secureLinkCreateLink", !1), printDisplayPlans(""), toggleSecureLinkCopySectionEnabled(!1), getSecureLinkBackend()) }));